# Automation of Users and Products in DefectDojo

Script: create_users_and_products.py

A Python script that uses the DefectDojo API to automate the creation of:

- A list of users and Products;
- Assigning users to products.

**How to run:**

1. Start a DefectDojo instance;
2. In the script, edit the parameters `BASE_DOMAIN` and `API_KEY` _(see below how to obtain them)_;
3. Create a file in the same directory as the script, called `users.txt`, which will list the users _(see below how to create it)_;
4. Run the scrip, via shell: `python script.py`.

**[IMPORTANT!] :**  After running the script, a file, `user_credentials.txt`, will be generated in the same directory, containing the passwords for each user.

---
**Where to obtain the `API_KEY` for the admin and a possible value for `BASE_DOMAIN`:**

1. Log in as admin (via browser);
2. In the upper-right corner, click on the user icon and select `API V2 Key`;
3. On the page that loads, copy the hash after the text `Your current API key is`.

If you are testing locally, set: `BASE_DOMAIN = "http://localhost:8080/"`.

**Format for the `users.txt` file:**
The file must contain one line per user with email, first name, last name, and product, separated by commas.
Also, pay attention to the separation of products by bars:

```plaintext
email1@example.com, John, Doe, Product1|Product2|Product3
```

Example:

```plaintext
iago@iago.com,Iago,Rios,Product 1 | Product 2
leo@leo.com,Leo,Maia,Product 2 | Product 2
italo@italo.com,Italo,Cunha,Product 3 | Product 2
```

**Output format in the `user_credentials.txt` file**:

```plaintext
UserFullName,UserLogin,UserPassword
```

Example:

```plaintext
Iago Rios, iago@iago.com, fD#\r=7;Gg?W
Leo Maia, leo@leo.com, 6EN+~[JRHxbz
Italo Cunha, italo@italo.com, 6w9tHB<QJ^N+
```
---

# Email Sending

Script: create_users_and_products.py

A Python script that uses the `user_credentials.txt` file generated by `create_users_and_products.py` to automatically send emails to new users.

**How to run:**

1. Make sure you have run `create_users_and_products.py` and that the `user_credentials.txt` file exists in the same directory;
2. In the script, edit the parameters `SMTP_SERVER`,  `SMTP_PORT`,  `SMTP_USER`, `SMTP_PASS` e `SENDER`;
3. Check if `EMAIL_TEMPLATE` matches the message to be sent;
4. Run the script via shell: `python send_emails.py`.
